# 变更提案：音频转写现代化 UI 界面

## 提案概述

为音频转写和会议纪要功能开发一个现代化的 Web UI 界面，提供直观的拖拽上传体验和易读的 Markdown 格式输出。

## 动机

当前音频转写功能仅提供 API 接口，存在以下问题：

1. **使用门槛高**：需要编写代码或使用 curl 命令，非技术人员无法使用
2. **输出不友好**：返回 JSON 格式，可读性差，不便于直接阅读和分享
3. **文件管理缺失**：无法指定上传和输出目录，缺乏统一的文件组织
4. **体验割裂**：没有可视化界面，无法实时查看处理进度

## 目标

### 核心功能

1. **现代化 UI 界面**
   - 黑白灰为主色调，点缀性使用彩色元素
   - 支持拖拽上传音频文件
   - 实时显示处理进度和状态
   - 响应式设计，支持桌面和移动端

2. **Markdown 输出格式**
   - 会议纪要以 `.md` 文件保存，易读易分享
   - 保留 LLM 生成的原始格式，避免复杂解析
   - 支持在线预览和下载

3. **灵活的文件管理**
   - 支持自定义上传目录
   - 支持自定义输出目录
   - 默认统一存储在 `uploads/audio/` 下
   - 自动生成易识别的文件名

4. **增强的 API**
   - 支持指定 `upload_dir` 和 `output_dir` 参数
   - 返回 Markdown 格式的纪要文本
   - 提供文件下载接口

### 非功能需求

1. **性能**：支持 100MB 以内音频文件的流畅上传和处理
2. **易用性**：无需阅读文档即可完成基本操作
3. **美观性**：遵循现代 UI 设计规范，而非传统信息管理系统风格
4. **可维护性**：前后端分离，代码结构清晰

## 设计原则

1. **简约优先**：去除不必要的装饰，聚焦核心功能
2. **以用户为中心**：优化音频上传 → 查看纪要的核心流程
3. **格式保真**：保留 LLM 生成的 Markdown 格式，不做过度处理
4. **渐进增强**：基础功能优先，后续可扩展历史记录、批量处理等

## 用户场景

### 场景 1：投研人员上传访谈录音

**当前流程（繁琐）**：
```bash
# 1. 编写 Python 脚本或 curl 命令
# 2. 上传音频文件
# 3. 等待 API 返回 JSON
# 4. 解析 JSON 提取纪要内容
# 5. 手动复制粘贴到文档
```

**新流程（简化）**：
```
1. 打开 Web 界面
2. 拖拽音频文件到上传区
3. 等待处理完成（进度条显示）
4. 在线预览 Markdown 纪要
5. 一键下载 .md 文件
```

### 场景 2：专家访谈纪要整理

**需求**：
- 多个音频文件分类存储（按项目、按日期）
- 纪要文件易于分享（Markdown 格式）
- 可以在不同设备上访问（响应式 UI）

**解决方案**：
- 支持自定义输出目录：`uploads/audio/项目A/`
- 自动生成文件名：`访谈-张三-2025-11-13.md`
- 提供在线预览和下载链接

## 技术方案概要

### 前端技术栈

- **框架**：React 18 + TypeScript（或 Vue 3）
- **样式**：TailwindCSS（黑白灰主题定制）
- **文件上传**：react-dropzone（拖拽支持）
- **Markdown 渲染**：react-markdown（预览）
- **构建工具**：Vite

### 后端增强

- **新增接口**：
  - `POST /api/v1/audio/transcribe-with-options`（支持目录参数）
  - `GET /api/v1/audio/download/{task_id}`（下载 Markdown 文件）
- **响应格式**：同时返回 JSON 和 Markdown 文本
- **文件管理**：支持自定义目录，默认 `uploads/audio/`

### 部署方式

- **开发环境**：前端 Vite dev server + 后端 Uvicorn
- **生产环境**：前端静态文件由 FastAPI 托管，统一端口

## 成功指标

1. **易用性**：新用户 5 分钟内完成首次音频转写
2. **输出质量**：Markdown 纪要格式清晰，无需二次编辑
3. **性能**：UI 响应时间 < 200ms，上传体验流畅
4. **用户反馈**：首批用户满意度 > 80%

## 风险与缓解

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 前端技术栈选型不当 | 开发周期延长 | 优先选择团队熟悉的框架 |
| Markdown 格式不统一 | 渲染异常 | 充分测试 LLM 输出格式 |
| 文件管理复杂度增加 | 维护成本上升 | 使用简单的目录结构，避免过度设计 |
| 移动端体验不佳 | 用户流失 | 优先保证桌面端体验，移动端作为附加功能 |

## 下一步

1. ✅ 创建 OpenSpec 提案
2. ⏳ 评审技术设计方案
3. ⏳ 实现 API 增强功能
4. ⏳ 开发前端 UI 界面
5. ⏳ 集成测试和用户验收

## 相关资源

- 现有 API 文档：`openspec/specs/api/spec.md`
- 音频转写变更：`openspec/changes/add-audio-transcription/`
- 设计参考：Modern UI 设计规范
